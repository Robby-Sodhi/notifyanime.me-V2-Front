(this["webpackJsonpnotify-anime-me"]=this["webpackJsonpnotify-anime-me"]||[]).push([[0],{56:function(e,t,n){},57:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var a=n(7),s=n(6),r=n(9),i=n(8),o=(n(56),n(57),n(0)),c=n.n(o),l=n(12),d=n.n(l),u="https://www.notifyanime.me/api";var h=function(){return!!m("session-key")},b=(new Date).getTimezoneOffset()/60,j=v((new Date).getTimezoneOffset(),60),m=function(e){var t;return(null===(t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)"))||void 0===t?void 0:t.pop())||""},p=function(e){return document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;")},f=function(e,t,n){return document.cookie="".concat(e,"=").concat(t,"; max-age=").concat(n,";")},g={monday:0,tuesday:1,wednesday:2,thursday:3,friday:4,saturday:5,sunday:6},y={0:"monday",1:"tuesday",2:"wednesday",3:"thursday",4:"friday",5:"saturday",6:"sunday"},O={0:"sunday",1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday"},x=function(){return O[(new Date).getDay()]};function v(e,t){return(e%t+t)%t}var w=function(e,t){for(e=e.toString();e.length<t;)e="0"+e;return e},k=n(97),_=n(93),S=n(99),C=n(100),N=n(2),L=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={menu:!1,loggedIn:!1},e.toggleDrawer=function(t){return function(n){("keydown"!==n.type||"Tab"!==n.key&&"Shift"!==n.key)&&e.setState({menu:t})}},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){h()&&this.setState({loggedIn:!0})}},{key:"render",value:function(){var e=this,t=[{text:"Discord",link:"https://www.discord.gg/fwBfvUdMjp",target:"_blank"},{text:"Donate",link:"https://paypal.me/RncServers?locale.x=en_US",target:"_blank"},{text:"About",link:"/About"}];return this.state.loggedIn?t.push({text:"Logout",onClick:function(){p("session-key"),window.location.reload()}}):t.push({text:"Login",link:"/Login"}),Object(N.jsxs)("header",{children:[Object(N.jsx)("a",{href:"/",children:Object(N.jsx)("button",{className:"logo btn--danger--solid btn--medium",children:"NotifyAnime.me"})}),Object(N.jsxs)("div",{className:"header",children:[t.map((function(e){return Object(N.jsx)("a",{href:e.link,target:e.target,children:Object(N.jsx)("button",{style:{marginLeft:"1vw"},className:"btn btn--danger--solid btn--medium",onClick:e.onClick?function(){return e.onClick()}:null,children:e.text})},e.text)})),Object(N.jsxs)("button",{onClick:function(){e.setState({menu:!e.state.menu})},style:{float:"right",marginTop:"1vh",border:"none"},children:[Object(N.jsx)("div",{className:"menu"}),Object(N.jsx)("div",{className:"menu"}),Object(N.jsx)("div",{className:"menu"})]})]}),Object(N.jsx)(k.a,{open:this.state.menu,anchor:"right",onClose:this.toggleDrawer(!1),children:Object(N.jsx)(_.a,{children:t.map((function(e){return Object(N.jsx)("a",{style:{color:"inherit",textDecoration:"inherit"},href:e.link,target:e.target,children:Object(N.jsx)(S.a,{button:!0,onClick:e.onClick?function(){return e.onClick()}:null,children:Object(N.jsx)(C.a,{primary:e.text})})},e.text)}))})})]})}}]),n}(c.a.Component),T=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={images:[{image:"https://cdn.myanimelist.net/images/anime/1134/111757.jpg",link:"https://myanimelist.net/anime/41025/Fumetsu_no_Anata_e"},{image:"https://cdn.myanimelist.net/images/anime/1200/111522.jpg",link:"https://myanimelist.net/anime/43325/Yuukoku_no_Moriarty_2nd_Season"},{image:"https://cdn.myanimelist.net/images/anime/1900/110097.webp",link:"https://myanimelist.net/anime/42361/Ijiranaide_Nagatoro-san"},{image:"https://cdn.myanimelist.net/images/anime/1493/113949.webp",link:"https://myanimelist.net/anime/42249/Tokyo_Revengers"},{image:"https://cdn.myanimelist.net/images/anime/1104/113797.webp",link:"https://myanimelist.net/anime/41457/86"},{image:"https://cdn.myanimelist.net/images/anime/1212/113448.webp",link:"https://myanimelist.net/anime/41265/Mars_Red"}]},e}return Object(s.a)(n,[{key:"render",value:function(){return Object(N.jsx)("div",{className:"imageGrid",children:this.state.images.map((function(e,t){return Object(N.jsx)("span",{children:Object(N.jsx)("a",{href:e.link,rel:"noreferrer",target:"_blank",children:Object(N.jsx)("img",{src:e.image,alt:""},t)})})}))})}}]),n}(c.a.Component),D=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={loggedIn:!1},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){h()&&this.setState({loggedIn:!0})}},{key:"render",value:function(){return Object(N.jsx)("div",{children:Object(N.jsxs)("div",{children:[Object(N.jsxs)("div",{className:"welcomeButtons",children:[!this.state.loggedIn&&Object(N.jsx)("a",{href:"/Login",children:Object(N.jsx)("button",{className:"Mobilebtn btn--danger--solid btn--large",children:"login"})}),!this.state.loggedIn&&Object(N.jsx)("a",{href:"/Signup",children:Object(N.jsx)("button",{className:"Mobilebtn btn--danger--solid btn--large",children:"signup"})}),this.state.loggedIn&&Object(N.jsx)("a",{href:"/Dashboard",children:Object(N.jsx)("button",{className:"Mobilebtn btn--danger--solid btn--large",children:"Dashboard"})})]}),Object(N.jsx)(T,{})]})})}}]),n}(c.a.Component),A=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return Object(N.jsxs)("div",{children:[Object(N.jsx)(L,{}),Object(N.jsx)(D,{})]})}}]),n}(c.a.Component),M=n(35),I=n.n(M),E=n(40),W=n(19),U=n(31),R=n(11),z=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return Object(N.jsxs)("div",{className:"form-group centerForm",children:[Object(N.jsxs)("form",{children:[Object(N.jsx)("label",{htmlFor:"username",children:"username"}),Object(N.jsx)("input",{className:"form-control",name:"username",placeholder:"username",value:this.props.username,onChange:function(t){return e.props.change(t)}}),Object(N.jsx)("label",{htmlFor:"password",children:"password"}),Object(N.jsx)("input",{className:"form-control",name:"password",type:"password",placeholder:"password",value:this.props.password,onChange:function(t){return e.props.change(t)}}),Object(N.jsx)("button",{className:"Mobilebtn btn--danger--solid btn--medium",style:{margin:"8px",marginLeft:"0"},onClick:function(t){e.props.onSubmit(t)},children:"Submit"})]}),this.props.error&&Object(N.jsx)("div",{class:"alert alert-danger",role:"alert",children:this.props.error}),Object(N.jsx)("div",{children:this.props.text})]})}}]),n}(c.a.Component),J=n(94);function F(e){return/\s/g.test(e)}var P=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).Defaultstate={username:"",password:"",error:"",redirect:null,loading:!1},e.state=Object(U.a)({},e.Defaultstate),e.change=function(t){e.setState({error:""}),e.setState(Object(W.a)({},t.target.name,t.target.value))},e.onSubmit=function(){var t=Object(E.a)(I.a.mark((function t(n){var a;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),console.log(e.state),e.state.username&&e.state.password){t.next=5;break}return e.setState({error:"Please fill out all the fields"}),t.abrupt("return");case 5:if(!F(e.state.username)){t.next=8;break}return e.setState({error:"no spaces allowed in username"}),t.abrupt("return");case 8:return a={username:e.state.username,password:e.state.password,type:e.props.type},e.setState({loading:!0}),t.next=12,fetch("".concat(u,"/authenticateUser"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(t){return console.log(t),0!=t.status&&t["session-key"]?(f("session-key",t["session-key"],3456e3),console.log("succesfully logged user in, redirecting to dashboard"),void e.setState({redirect:"/Dashboard"})):void e.setState({error:e.props.error})})).catch((function(t){console.error(t),e.setState({error:"Network Error: server is down or client lost connection"})}));case 12:e.setState({loading:!1});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){h()&&(console.log("user logged in redirecting to dashboard"),this.setState({redirect:"/Dashboard"}))}},{key:"render",value:function(){return this.state.redirect?Object(N.jsx)(R.a,{to:this.state.redirect}):this.state.loading?Object(N.jsxs)("div",{children:[Object(N.jsx)(L,{}),Object(N.jsx)(J.a,{className:"centered"})]}):("login"===this.props.type?e=Object(N.jsxs)("div",{style:{fontWeight:600},children:["Don't have an account? ",Object(N.jsx)("a",{href:"/Signup",children:"Sign up"})]}):"signup"==this.props.type&&(e=Object(N.jsxs)("div",{style:{fontWeight:600},children:["Already have an account? ",Object(N.jsx)("a",{href:"/Login",children:"Login"})]})),Object(N.jsxs)("div",{children:[Object(N.jsx)(L,{}),Object(N.jsx)(z,{onSubmit:this.onSubmit,change:this.change,username:this.state.username,password:this.state.password,error:this.state.error,text:e})]}));var e}}]),n}(c.a.Component),G=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return Object(N.jsx)(P,{type:"login",error:"Login invalid"})}}]),n}(c.a.Component),B=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return Object(N.jsxs)("div",{children:[Object(N.jsx)(L,{}),Object(N.jsxs)("center",{children:[Object(N.jsx)("a",{style:{color:"inherit",textDecoration:"inherit"},href:"https://github.com/Robby-Sodhi/notifyanime.me-V2-Front",children:Object(N.jsx)("i",{className:"fa fa-github fa-5x",children:"Github"})}),Object(N.jsx)("p",{children:"NotifyAnime.me is planned to be full opensource on the above Github."})]})]})}}]),n}(c.a.Component),H=n(51),V=n(98),K=n(95),Y={start_time:null,day_of_the_week:null},q=function(e){var t=[],n=[],a=[],s=[];(e=e.data).forEach((function(e){"my_list_status"in e.node&&"status"in e.node.my_list_status&&"status"in e.node&&("watching"===e.node.my_list_status.status?(t.push(e),"currently_airing"===e.node.status&&(s.push(e),"broadcast"in e.node&&"start_time"in e.node.broadcast?e.node.broadcast=function(e,t,n,a){for(var s=parseInt(t.slice(0,2)),r=parseInt(t.slice(3,5)),i=g[e],o=v(s-(9+n),24),c=v(r-a,60);r-a>60;)s+=1,r-=60;for(;r-a<0;)s-=1,r+=60;for(;s-(9+n)<0;)(i-=1)<0&&(i=7+i),s+=24;for(;s-(9+n)>24;)(i+=1)>6&&(i-=7),s-=24;return{day_of_the_week:y[i],start_time:"".concat(w(o,2),":").concat(w(c,2))}}(e.node.broadcast.day_of_the_week,e.node.broadcast.start_time,b,j):e.node.broadcast=Y)):"completed"===e.node.my_list_status.status?n.push(e):"plan_to_watch"===e.node.my_list_status.status&&a.push(e))}));var r=Object(U.a)({},g);r[x()]=-1;for(var i=g[x()]+1,o=1;;){if(i>6&&(i=0),-1===r[y[i]]){r[y[i]]=0;break}r[y[i]]=o,i++,o++}return s.sort((function(e,t){return null===e.node.broadcast.day_of_the_week||null===e.node.broadcast.start_time?1:null===t.node.broadcast.day_of_the_week||null===t.node.broadcast.start_time||r[e.node.broadcast.day_of_the_week]<r[t.node.broadcast.day_of_the_week]?-1:1})),{currentlyAiring:s,watching:t,completed:n,planToWatch:a}},Q=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={redirect:null,loggedInToMal:!0,loading:!1,watchList:null},e.SendAuthorizationCodeToServer=function(t,n,a){var s={sessionKey:t,authorizationCode:n,codeChallenge:a};return fetch("".concat(u,"/authenticateMal"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){if(!e.status)throw new Error("session-key invalid or mal is down")})).catch((function(t){console.error(t),p("session-key"),e.setState({redirect:"/Login"})}))},e.adjustEpisode=function(t,n){var a=t.node.my_list_status.num_episodes_watched;if("increment"===n)a++;else{if("decrement"!=n)throw Error("adjustEpisode invalid argument");a--}if(0!=t.node.num_episodes&&a>t.node.num_episodes)alert("This show only has ".concat(t.node.num_episodes," episodes"));else if(!(a<0)){var s={numWatched:a,id:t.node.id};fetch("".concat(u,"/adjustEpisode"),{method:"POST",headers:{"Content-Type":"text/plain","session-key":m("session-key")},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(t){if(console.log(t),!t.status)return p("session-key"),void e.setState({redirect:"/Login"})})).catch((function(){return alert("failed to update WatchList, server is down or client lost connection")}));var r=Object(U.a)({},e.state.watchList);console.log(r);var i,o=Object(H.a)(r.currentlyAiring);try{for(o.s();!(i=o.n()).done;){var c=i.value;c.node.id==t.node.id&&(c.node.my_list_status.num_episodes_watched=a)}}catch(l){o.e(l)}finally{o.f()}e.setState({watchList:r})}},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=Object(E.a)(I.a.mark((function e(){var t,n,a=this;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({loading:!0}),t=m("session-key"),console.log(t),t){e.next=7;break}return console.error("session-key missing from cookie, redirecting to login"),this.setState({redirect:"/Login"}),e.abrupt("return");case 7:if(!(n=new URL(document.location).searchParams).get("code")){e.next=17;break}if(!m("code-challenge")){e.next=15;break}return e.next=12,this.SendAuthorizationCodeToServer(t,n.get("code"),m("code-challenge"));case 12:window.history.replaceState({},document.title,"/Dashboard"),e.next=17;break;case 15:return this.setState({loggedInToMal:!1}),e.abrupt("return");case 17:return e.next=19,fetch("".concat(u,"/getWatchList"),{method:"GET",headers:{"Content-Type":"text/plain","session-key":t}}).then((function(e){return e.json()})).then((function(e){if(!e.sessionKeyValid)throw new Error("session key invalid");e.WatchList?a.setState({watchList:q(e.WatchList)}):a.setState({loggedInToMal:!1})})).catch((function(e){console.error(e),p("session-key"),a.setState({redirect:"/Login"})}));case 19:this.setState({loading:!1});case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(this.state.redirect)return Object(N.jsx)(R.a,{to:this.state.redirect});if(this.state.loggedInToMal)return this.state.loading?Object(N.jsxs)("div",{children:[Object(N.jsx)(L,{}),Object(N.jsx)(J.a,{className:"centered"})]}):this.state.watchList&&this.state.watchList.currentlyAiring&&this.state.watchList.watching?Object(N.jsxs)("div",{children:[Object(N.jsx)(L,{}),Object(N.jsx)("div",{style:{marginLeft:"6%"},children:Object(N.jsx)(V.a,{display:"flex",justifyContent:"space-evenly",flexWrap:"wrap",alignContent:"space-between",children:this.state.watchList.currentlyAiring.map((function(t){return Object(N.jsxs)("div",{className:"mobileLeftAlign",children:[Object(N.jsxs)(V.a,{display:"flex",width:"500px",height:"300px",margin:"2rem",children:[Object(N.jsx)("img",{src:t.node.main_picture.medium,alt:t.node.title}),Object(N.jsxs)("div",{className:"dashboardText",children:[Object(N.jsx)("p",{children:"".concat((n=t.node.broadcast.day_of_the_week,n?n.charAt(0).toUpperCase()+n.slice(1):null)," ").concat(t.node.broadcast.start_time)}),Object(N.jsx)("p",{children:"\n                            Watched: ".concat(t.node.my_list_status.num_episodes_watched,"\n                            ")}),Object(N.jsxs)(K.a,{container:!0,direction:"row",justifyContent:"center",alignItems:"",spacing:1,style:{marginRight:"50px"},children:[Object(N.jsx)(K.a,{item:!0,children:Object(N.jsx)("button",{onClick:function(){return e.adjustEpisode(t,"increment")},className:"Mobilebtn btn--danger--solid btn--medium",children:"+"})}),Object(N.jsx)(K.a,{item:!0,children:Object(N.jsx)("button",{onClick:function(){return e.adjustEpisode(t,"decrement")},className:"Mobilebtn btn--danger--solid btn--medium",children:"-"})})]})]})]},t.node.id),Object(N.jsx)("p",{className:"dashboardText",children:t.node.title})]});var n}))})})]}):Object(N.jsx)("p",{children:"no airing/watching shows"});var t=btoa(crypto.getRandomValues(new Uint8Array(128))).substr(0,128);(t.length<43||t>128)&&(p("session-key"),this.setState({redirect:"/Home"})),f("code-challenge",t,3600);var n="https://myanimelist.net/v1/oauth2/authorize?response_type=code&client_id=".concat("0ed447cbcf7f21fe2572ce266fc0ce26","&code_challenge=").concat(t);return console.log(n),Object(N.jsxs)("div",{children:[Object(N.jsx)(L,{}),Object(N.jsx)("a",{href:n,children:Object(N.jsx)("button",{className:"MobilebtnNoHover btn--warning--solid btn--medium center-screen",children:"Sign-in to MyAnimeList"})})]})}}]),n}(c.a.Component),X=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return Object(N.jsx)(P,{type:"signup",error:"Username already exists"})}}]),n}(c.a.Component),Z=n(37),$=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return Object(N.jsx)(Z.a,{children:Object(N.jsxs)(R.d,{children:[Object(N.jsx)(R.b,{path:"/",exact:!0,component:A}),Object(N.jsx)(R.b,{path:"/Home",exact:!0,component:A}),Object(N.jsx)(R.b,{path:"/Login",exact:!0,component:G}),Object(N.jsx)(R.b,{path:"/About",exact:!0,component:B}),Object(N.jsx)(R.b,{path:"/Dashboard",exact:!0,component:Q}),Object(N.jsx)(R.b,{path:"/Signup",exact:!0,component:X})]})})}}]),n}(c.a.Component);d.a.render(Object(N.jsx)($,{}),document.getElementById("root"))}},[[72,1,2]]]);
//# sourceMappingURL=main.7e0796c7.chunk.js.map